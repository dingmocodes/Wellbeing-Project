<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Health Progress Tracker</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            background: #EDE1D4;
        }

        header {
            background: linear-gradient(to right, rgba(0, 153, 76, 1), rgba(76, 175, 80, 0.5));
            color: white;
            padding: 15;
            margin: 0;
            text-align: center;
            position: relative; /* Allow absolute positioning of the toggle button */
        }
    
        /* Water counter style */
        #water-counter {
            position: absolute; /* Position the counter in the top right corner */
            top: 20px;         /* Adjust the vertical position */
            right: 20px;       /* Adjust the horizontal position */
            background-color: rgba(255, 255, 255, 0.8); /* Light background */
            padding: 10px;
            border-radius: 5px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.2); /* Shadow for depth */
        }


        .toggle-button {
            position: absolute;
            left: 250px; /* Distance from the left edge */
            top: 50%; /* Centered vertically */
            transform: translateY(-50%); /* Adjust for the button height */
            background: transparent; /* Transparent background */
            border: none; /* No border */
            color: white; /* White text color */
            font-size: 20px; /* Increase font size */
            cursor: pointer; /* Pointer cursor on hover */
        }

        .container {
            padding: 20px;
        }

        .main-content {
            margin-top: 20px;
        }

        h2 {
            font-size: 24px;
            color: #333;
            margin: 0;
            text-align: center;
        }

        p {
            font-size: 16px;
            color: #555;
            text-align: center;
        }

        /* Fixed bottom bar for input and button */
        .text-bar {
            position: fixed;
            bottom: 0;
            width: 100%;
            background-color: #fff;
            padding: 10px;
            box-shadow: 0 -2px 10px rgba(0, 0, 0, 0.1);
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .text-bar input[type="text"] {
            width: 75%;
            padding: 10px;
            border: 1px solid #ccc;
            border-radius: 4px;
            font-size: 16px;
        }

        .text-bar button {
            padding: 10px 20px;
            border: none;
            background-color: #4CAF50;
            color: white;
            font-size: 16px;
            cursor: pointer;
            border-radius: 4px;
            margin-left: 10px;
        }

        .text-bar button:hover {
            background-color: #45a049;
        }

        /* Side task bar */
        .side-task-bar {
            position: fixed;
            top: 0;
            left: -200px; /* Initially hidden, off the screen */
            width: 200px;
            height: 100%;
            background-color: #333;
            color: white;
            padding: 15px;
            transition: left 0.3s; /* Smooth transition */
        }

        .side-task-bar ul {
            list-style: none;
            padding: 0;
        }

        .side-task-bar ul li {
            padding: 10px;
            border-bottom: 1px solid #444;
            cursor: pointer; /* Indicate clickable items */
        }

        .side-task-bar ul li a {
            color: white; /* Default color */
            text-decoration: none;
        }

        .side-task-bar ul li a:visited {
            color: yellow; /* Bright color after the link is clicked */
        }

        .side-task-bar ul li a:hover {
            text-decoration: underline; /* Underline on hover */
        }

        /* Additional styling for the input sections */
        .input-section {
            margin: 20px 0;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .input-section textarea {
            width: 90%;
            height: 60px;
            padding: 10px;
            border: 1px solid #ccc;
            border-radius: 4px;
            margin-bottom: 10px;
            font-size: 16px;
            box-shadow: 10px 10px 20px rgba(0, 0, 0, 0.5); /* Black shadow */
        }

        /* Submit button section */
        .submit-section {
            display: flex;
            justify-content: center;
            margin-top: 20px;
        }

        .submit-section button {
            padding: 10px 20px;
            border: none;
            background-color: #4CAF50;
            color: white;
            font-size: 16px;
            cursor: pointer;
            border-radius: 4px;
        }

        .submit-section button:hover {
            background-color: #45a049;
        }

        /* Checklist section */
        .checklist {
            margin-top: 20px;
            display: none; /* Hidden by default */
        }

        .checklist ul {
            list-style: none;
            padding: 0;
        }

        .checklist ul li {
            margin: 5px 0;
            display: flex;
            align-items: center;
        }

        .checklist ul li input {
            margin-right: 10px;
        }
    </style>
</head>
<body>

<header>
    <button class="toggle-button" onclick="toggleSidebar()">â˜°</button> <!-- Toggle button -->
    <h1>Woody Wellness</h1>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Retrieve the water amount from localStorage
            let waterAmount = parseInt(localStorage.getItem('waterAmount')) || 0;
            document.getElementById('waterCounter').textContent = waterAmount; // Update the displayed water amount
        });
    </script>
    <div id="water-counter">
        <h2>Water Amount: <span id="waterCounter">0</span></h2>
    </div>
</header>

<div class="container">
    <div class="main-content">
        <h2>Personal Wellbeing</h2>
        <p>Feel free to provide info on your habits. Press 'Submit' to receive feedback..</p>

        <!-- Text boxes for user input -->
        <div class="input-section">
            <textarea placeholder="What is your typical daily routine?"></textarea>
            <textarea placeholder="What changes do you want?"></textarea>
            <textarea placeholder="Who do you hang out with?"></textarea>
            <textarea placeholder="What are your hobbies or interest?"></textarea>
            <textarea placeholder="How do you feel?"></textarea>
        </div>

        <!-- Submit button for user input -->
        <div class="submit-section">
            <button onclick="submitUserInfo()">Submit</button>
        </div>

        <!-- Checklist section -->
        <div class="checklist" id="checklist">
            <h2>Your Checklist</h2>
            <ul id="checklistItems"></ul>
        </div>
    </div>
</div>

<!-- Side task bar -->
<div class="side-task-bar" id="sideTaskBar">
    <h3>Tasks</h3>
    <ul>
        <li><a href="{{ url_for('index') }}">Home</a></li>
        <li><a href="{{ url_for('checklist') }}">Activities</a></li>
        <li><a href="{{ url_for('physical') }}">Progress</a></li>
    </ul>
</div>

<!-- Fixed text input bar at the bottom -->
<!-- <div class="text-bar">
    <input type="text" id="user-query" placeholder="Respond to AI...">
    <button onclick="callBedrock()">Send</button>
</div> -->

<script>
    // Function to toggle the sidebar visibility
    function toggleSidebar() {
        const sidebar = document.getElementById('sideTaskBar');
        sidebar.style.left = sidebar.style.left === '0px' ? '-200px' : '0px';
    }

    // Function to send data to server
    async function callBedrock() {
        const userQuery = document.getElementById('user-query').value;

        const response = await fetch('http://localhost:8080/call_bedrock', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify({
                user_response: userQuery
            }),
        });

        const data = await response.json();
        // console.log(data); 
        // alert(data.model_output || "Response not available");
    }

    // Function to submit user info
    async function submitUserInfo() {
        const dailyRoutine = document.querySelectorAll('.input-section textarea')[0].value;
        const desiredChanges = document.querySelectorAll('.input-section textarea')[1].value;
        const idealLife = document.querySelectorAll('.input-section textarea')[2].value;
        const mentalPercent = document.querySelectorAll('.input-section textarea')[3].value;
        const physicalPercent = document.querySelectorAll('.input-section textarea')[4].value;

        const prompt = `
            Given the following information:
            
            Daily Routine: ${dailyRoutine}
            Desired Changes: ${desiredChanges}
            Ideal Life: ${idealLife}
            Mental Health Focus: ${mentalPercent}%
            Physical Health Focus: ${physicalPercent}%

            Please provide a list of mental and physical activities that could help
            the user achieve their ideal life. Each line of the list should be brief. Remember the user's prompt and your response for the next 24 hours. Return the list in **JSON format only**, 
            without any additional text or explanations like this:
            {
                "mental_activities": [
                    "Activity Name: Brief description of what the activity involves.",
                    "Another Activity(s): Brief description explaining its benefits."
                ],
                "physical_activities": [
                    "Physical Activity Name: A short explanation of how to perform the activity.",
                    "Another Physical Activity(s): Description of the physical benefits and any necessary details."
                ]
            }
        `;

        const response = await fetch('http://localhost:8080/call_bedrock', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify({
                user_response: prompt
            }),
        });

        const data = await response.json();

        // console.log(data); 
        // alert(data.model_output || "Response not available");

        localStorage.setItem('myData', JSON.stringify(data));
        window.location.href = 'checklist';
    }
</script>

</body>
</html>

