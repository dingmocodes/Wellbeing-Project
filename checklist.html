<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Physical Health</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background: #EDE1D4;
        }

        /* Water counter style */
        #water-counter {
            position: absolute; /* Position the counter in the top right corner */
            top: 20px;         /* Adjust the vertical position */
            right: 20px;       /* Adjust the horizontal position */
            background-color: rgba(255, 255, 255, 0.8); /* Light background */
            padding: 10px;
            border-radius: 5px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.2); /* Shadow for depth */
            color: black; /* Change the text color to black */
        }

        header {
            background: linear-gradient(to right, rgba(0, 153, 76, 1), rgba(76, 175, 80, 0.5));
            color: white;
            padding: 15px;
            text-align: center;
        }
        .container {
            padding: 20px;
        }
        .animated-image {
            width: 500px; /* Adjust width as needed */
            height: 500px; /* Adjust height as needed */
            background-image: url('.man/happy talk animation/man_neutral.png');
            background-size: cover;
        }
    </style>
</head>
<body>
    <header>
        <h1>Activities</h1>
        <script>
            document.addEventListener('DOMContentLoaded', function() {
                // Retrieve the water amount from localStorage
                let waterAmount = parseInt(localStorage.getItem('waterAmount')) || 0;
                document.getElementById('waterCounter').textContent = waterAmount; // Update the displayed water amount
            });
        </script>
        <div id="water-counter">
            <h2>Water Amount: <span id="waterCounter">0</span></h2>
        </div>
    </header>

    <div class="container">
        <h2>Introducing your Personalized Activities</h2>
        <a href="{{ url_for('index') }}">Go back to Home</a>
    </div>

    <div class="activities-section">
        <h2>Mental Activities</h2>
        <ul id="mentalActivitiesList"></ul>
    </div>

    <div class="activities-section">
        <h2>Physical Activities</h2>
        <ul id="physicalActivitiesList"></ul>
    </div>

    <script>
        // Initialize or retrieve the water amount from localStorage
        let waterAmount = parseInt(localStorage.getItem('waterAmount')) || 0;

        // Function to update the water amount in localStorage
        function updateWaterAmount(amount) {
            waterAmount = Math.max(0, waterAmount + amount); // Ensure waterAmount doesn't go below 0
            localStorage.setItem('waterAmount', waterAmount);
            document.getElementById('waterCounter').textContent = waterAmount;
        }

        function createCheckbox(activity) {
            const li = document.createElement('li');
            const checkbox = document.createElement('input');
            checkbox.type = 'checkbox';
            checkbox.setAttribute('data-activity', activity); // Store activity name as data attribute
            
            // Load checked state from localStorage
            const checkedState = localStorage.getItem(activity);
            checkbox.checked = (checkedState === 'true'); // Set checkbox checked state

            // Update water amount when checked/unchecked
            checkbox.addEventListener('change', function() {
                const waterValue = parseInt(this.getAttribute('data-water')) || 0; // Get water value from data attribute
                if (this.checked) {
                    updateWaterAmount(waterValue); // If checked, add water
                    localStorage.setItem(activity, 'true'); // Store checked state
                } else {
                    updateWaterAmount(-waterValue); // If unchecked, remove water
                    localStorage.setItem(activity, 'false'); // Store unchecked state
                }
            });

            // Set a data attribute for the water value
            checkbox.setAttribute('data-water', 10); // Example water value, you can adjust this per activity

            const label = document.createElement('label');
            label.textContent = activity;

            li.appendChild(checkbox);
            li.appendChild(label);
            return li;
        }

        // Retrieve the JSON data from localStorage
        const storedData = localStorage.getItem('myData');
        if (storedData) {
            // Parse the JSON data
            const jsonData = JSON.parse(storedData);
            const modelOutputString = jsonData.model_output;

            // Parse the string to get the actual JSON data
            const parsedData = JSON.parse(modelOutputString);

            // Render mental activities
            const mentalActivitiesList = document.getElementById('mentalActivitiesList');
            parsedData.mental_activities.forEach(activity => {
                const li = createCheckbox(activity);
                mentalActivitiesList.appendChild(li);
            });

            // Render physical activities
            const physicalActivitiesList = document.getElementById('physicalActivitiesList');
            parsedData.physical_activities.forEach(activity => {
                const li = createCheckbox(activity);
                physicalActivitiesList.appendChild(li);
            });
        } else {
            console.log('No task data found in localStorage');
        }
    </script>
</body>
</html>
